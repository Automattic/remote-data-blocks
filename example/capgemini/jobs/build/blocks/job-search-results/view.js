import*as e from"@wordpress/interactivity";var t={d:(e,i)=>{for(var o in i)t.o(i,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:i[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const i=(o={getContext:()=>e.getContext,store:()=>e.store},l={},t.d(l,o),l);var o,l,n=function(e,t,i,o){return new(i||(i=Promise))((function(l,n){function r(e){try{v(o.next(e))}catch(e){n(e)}}function u(e){try{v(o.throw(e))}catch(e){n(e)}}function v(e){var t;e.done?l(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,u)}v((o=o.apply(e,t||[])).next())}))};function r(e,t,i){return n(this,void 0,void 0,(function*(){var o;const l=yield window.fetch(e.restUrl,{body:JSON.stringify({block_name:e.blockName,query_key:t,query_input:i}),headers:{"Content-Type":"application/json"},method:"POST"}),{body:n}=yield l.json();return null!==(o=null==n?void 0:n.results)&&void 0!==o?o:[]}))}const{actions:u,state:v}=(0,i.store)("remote-data-blocks/capgemini-jobs",{actions:{search:()=>n(void 0,void 0,void 0,(function*(){var e;const t=v.activeFilters.reduce(((e,t)=>{var i;return Object.assign(Object.assign({},e),{[t.type]:[...null!==(i=e[t.type])&&void 0!==i?i:[],t.title]})}),{}),i=Object.fromEntries(Object.entries(t).map((([e,t])=>[e,t.join(",")]))),o=Object.assign(Object.assign({},i),{country_code:v.countryCode,page:v.page,search:v.searchTerms,size:v.size}),l=yield r(v,"__DISPLAY__",o);v.jobs=null!==(e=l.map((e=>{var t,i,o,l,n,r;return{id:null!==(o=null===(i=null===(t=e.result)||void 0===t?void 0:t.id)||void 0===i?void 0:i.value)&&void 0!==o?o:"id",title:null!==(r=null===(n=null===(l=e.result)||void 0===l?void 0:l.title)||void 0===n?void 0:n.value)&&void 0!==r?r:"title"}})))&&void 0!==e?e:[];const n=yield r(v,"RemoteDataBlocks\\Example\\Capgemini\\Jobs\\CapgeminiJobFiltersQuery",{country_code:v.countryCode,search:v.searchTerms});console.log(n),v.filterGroups=n.map((e=>{var t,i,o,l,n,r,u,v,d,a,s,c;return{filters:JSON.parse(null!==(o=null===(i=null===(t=null==e?void 0:e.result)||void 0===t?void 0:t.items)||void 0===i?void 0:i.value)&&void 0!==o?o:"[]").map((t=>{var i,o,l,n,r,u;return{id:`${null===(o=null===(i=e.result)||void 0===i?void 0:i.type)||void 0===o?void 0:o.value}_${t.value}`,count:null!==(l=t.count)&&void 0!==l?l:0,title:t.value,type:null!==(u=null===(r=null===(n=e.result)||void 0===n?void 0:n.type)||void 0===r?void 0:r.value)&&void 0!==u?u:""}})),title:null!==(d=null!==(r=null===(n=null===(l=e.result)||void 0===l?void 0:l.title)||void 0===n?void 0:n.value)&&void 0!==r?r:null===(v=null===(u=e.result)||void 0===u?void 0:u.type)||void 0===v?void 0:v.value)&&void 0!==d?d:"",type:null!==(c=null===(s=null===(a=e.result)||void 0===a?void 0:a.type)||void 0===s?void 0:s.value)&&void 0!==c?c:""}})),v.activeFilters=[]})),toggleFilter:()=>{const{filter:e}=(0,i.getContext)(),t=t=>e.type===t.type&&e.title===t.title;v.activeFilters.some(t)?v.activeFilters=v.activeFilters.filter((e=>!t(e))):v.activeFilters.push(e),u.search()},updateSearchTerms:e=>{var t,i;v.searchTerms=null!==(i=null===(t=e.target)||void 0===t?void 0:t.value)&&void 0!==i?i:"","keydown"===e.type&&"Enter"===e.key&&u.search()}},state:{}});