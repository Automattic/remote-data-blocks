(()=>{"use strict";var e={20:(e,t,r)=>{var n=r(609),o=Symbol.for("react.element"),a=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};t.jsx=function(e,t,r){var n,c={},i=null,p=null;for(n in void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(p=t.ref),t)a.call(t,n)&&!l.hasOwnProperty(n)&&(c[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===c[n]&&(c[n]=t[n]);return{$$typeof:o,type:e,key:i,ref:p,props:c,_owner:s.current}}},848:(e,t,r)=>{e.exports=r(20)},609:e=>{e.exports=window.React}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();const n=window.wp.blocks,o=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"remote-data-blocks/elden-ring-map","usesContext":["remote-data-blocks/remoteData"],"version":"0.1.0","title":"Elden Ring Map","category":"widgets","icon":"location-alt","description":"Elden Ring Map","example":{},"supports":{"html":false,"inserter":false},"textdomain":"remote-data-blocks","editorScript":["file:./index.js","leaflet-script"],"editorStyle":["leaflet-style"],"render":"file:./render.php","viewScript":["file:./view.js","leaflet-script"],"viewStyle":["leaflet-style"]}'),a=window.wp.blockEditor,s=window.wp.element;function l({coordinates:e}){const[t,n]=(0,s.useState)(),o=(0,s.useRef)(),a=(0,s.useRef)(),l=(0,s.useRef)();return(0,s.useEffect)((()=>{if(!e?.length)return;const t=setInterval((()=>{r.g.L&&(clearInterval(t),n(r.g.L))}),100);return()=>clearInterval(t)}),[e]),(0,s.useEffect)((()=>{if(o.current&&t){if(!a.current){const r=t.map(o.current).setView([e[0].x,e[0].y],25);t.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:4}).addTo(r),r._handlers.forEach((e=>e.disable())),a.current=r,l.current=t.layerGroup().addTo(a.current)}l.current.clearLayers(),e.forEach((e=>{t.marker([e.x,e.y]).addTo(l.current)})),a.current.flyTo([e[0].x,e[0].y])}}),[e,t]),React.createElement("div",{ref:o,id:"map",style:{height:400}})}const c=window.wp.i18n;var i=r(848);(0,n.registerBlockType)(o.name,{...o,edit:function({context:e}){const t=(0,a.useBlockProps)(),r=(0,a.useInnerBlocksProps)(t),n=e["remote-data-blocks/remoteData"],o=n?.results||[];return n?React.createElement(React.Fragment,null,React.createElement(a.BlockControls,null),React.createElement("div",r,React.createElement(l,{coordinates:o}))):React.createElement("p",{style:{color:"red",padding:"20px"}},(0,c.__)("This block only supports being rendered inside of an Elden Ring Map Query block.","remote-data-blocks"))},save:function(){return(0,i.jsx)("p",Object.assign({},a.useBlockProps.save(),{children:(0,i.jsx)(a.InnerBlocks.Content,{})}))}})})();